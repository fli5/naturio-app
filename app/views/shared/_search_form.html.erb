<!-- app/views/products/_search_form.html.erb -->
<!-- Feature 2.6 âœ¯ -->

<div class="card border-0 shadow-sm mb-4">
  <div class="card-body">
    <h5 class="card-title mb-3">
      <i class="bi bi-search me-2"></i>Search Products
    </h5>
    
    <%= form_with url: products_path, method: :get, local: true, class: "search-form" do |f| %>
      <div class="row g-3">

        <div class="col-12">
          <label for="search" class="form-label">Keyword</label>
          <div class="input-group">
            <span class="input-group-text bg-white">
              <i class="bi bi-search text-muted"></i>
            </span>
            <%= text_field_tag :search, params[:search], 
                class: "form-control", 
                id: "search",
                placeholder: "Enter product name or description..." %>
          </div>
        </div>
        
        <!-- (Feature 2.6) -->
        <div class="col-12">
          <label for="search_category" class="form-label">Category</label>
          <%= select_tag :search_category, 
              options_for_select(
                [['All Categories', '']] + Category.alphabetical.pluck(:name, :id),
                params[:search_category]
              ),
              class: "form-select",
              id: "search_category" %>
        </div>
        
        <div class="col-12">
          <div class="d-grid gap-2">
            <%= submit_tag "Search", class: "btn btn-success" %>
            
            <% if params[:search].present? || params[:search_category].present? %>
              <%= link_to "Clear Search", products_path, class: "btn btn-outline-secondary btn-sm" %>
            <% end %>
          </div>
        </div>
      </div>
    <% end %>
    
    <% if params[:search].present? %>
      <div class="mt-3 p-2 bg-light rounded">
        <small class="text-muted">
          Searching for: <strong>"<%= params[:search] %>"</strong>
          <% if params[:search_category].present? %>
            in <strong><%= Category.find_by(id: params[:search_category])&.name %></strong>
          <% else %>
            in <strong>All Categories</strong>
          <% end %>
        </small>
      </div>
    <% end %>
  </div>
</div>
