<%# Feature 3.1.5 %>
<% content_for :title, "My Addresses - Northern Harvest" %>

<div class="container py-5">
  <%= render 'shared/breadcrumbs', items: [
    { name: 'Home', path: root_path },
    { name: 'My Account', path: edit_customer_registration_path },
    { name: 'Addresses', path: nil }
  ] %>

  <div class="d-flex justify-content-between align-items-center mb-4">
    <h1 class="h3 mb-0">My Addresses</h1>
    <%= link_to new_customers_address_path, class: "btn btn-success" do %>
      <i class="bi bi-plus-lg me-1"></i> Add New Address
    <% end %>
  </div>

  <% if @addresses.any? %>
    <div class="row g-4">
      <% @addresses.each do |address| %>
        <div class="col-md-6">
          <div class="card h-100 border-0 shadow-sm">
            <div class="card-body">
              <div class="d-flex justify-content-between align-items-start mb-3">
                <span class="badge <%= address.address_type == 'shipping' ? 'bg-primary' : 'bg-secondary' %>">
                  <%= address.address_type.titleize %>
                </span>
                <div class="dropdown">
                  <button class="btn btn-sm btn-outline-secondary" data-bs-toggle="dropdown">
                    <i class="bi bi-three-dots-vertical"></i>
                  </button>
                  <ul class="dropdown-menu dropdown-menu-end">
                    <li>
                      <%= link_to edit_customers_address_path(address), class: "dropdown-item" do %>
                        <i class="bi bi-pencil me-2"></i> Edit
                      <% end %>
                    </li>
                    <li><hr class="dropdown-divider"></li>
                    <li>
                      <%= button_to customers_address_path(address), 
                          method: :delete,
                          class: "dropdown-item text-danger",
                          data: { confirm: "Are you sure you want to delete this address?" } do %>
                        <i class="bi bi-trash me-2"></i> Delete
                      <% end %>
                    </li>
                  </ul>
                </div>
              </div>
              
              <address class="mb-0">
                <strong><%= address.street_address %></strong><br>
                <%= address.city %>, <%= address.province.code %><br>
                <%= address.postal_code %><br>
                <span class="text-muted">Canada</span>
              </address>
            </div>
          </div>
        </div>
      <% end %>
    </div>
  <% else %>
    <div class="text-center py-5">
      <i class="bi bi-geo-alt text-muted" style="font-size: 4rem;"></i>
      <h4 class="mt-3">No addresses yet</h4>
      <p class="text-muted">Add an address to make checkout faster.</p>
      <%= link_to "Add Address", new_customer_address_path, class: "btn btn-success" %>
    </div>
  <% end %>
</div>
